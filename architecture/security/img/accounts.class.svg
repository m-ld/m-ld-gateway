<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="645px" preserveAspectRatio="none" style="width:1136px;height:645px;background:#FFFFFF;" version="1.1" viewBox="0 0 1136 645" width="1136px" zoomAndPan="magnify"><defs/><g><!--MD5=[6de492f04047ff8a778df2bea690e363]
class Gateway--><g id="elem_Gateway"><rect codeLine="6" fill="#F1F1F1" height="103.7305" id="Gateway" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="196" x="186.5" y="159.5"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55" x="257" y="176.1016">«domain»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="52" x="258.5" y="190.2344">«service»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="256" y="206.3008">Gateway</text><line style="stroke:#181818;stroke-width:0.5;" x1="187.5" x2="381.5" y1="214.2539" y2="214.2539"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184" x="192.5" y="231.7891">rootAccount : UserAccount</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="192.5" y="248.2773">rootKey : AuthKey</text><line style="stroke:#181818;stroke-width:0.5;" x1="187.5" x2="381.5" y1="255.2305" y2="255.2305"/></g><!--MD5=[f9a29335b499db729be669fd1bd54958]
class Account--><g id="elem_Account"><rect codeLine="13" fill="#F1F1F1" height="103.7305" id="Account" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="200" x="166.5" y="354.5"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="59" x="237" y="371.1016">«abstract»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="54" x="239.5" y="385.2344">«subject»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="238.5" y="401.3008">Account</text><line style="stroke:#181818;stroke-width:0.5;" x1="167.5" x2="365.5" y1="409.2539" y2="409.2539"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="188" x="172.5" y="426.7891">subdomain : Subdomain [*]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175" x="172.5" y="443.2773">naming : any | uuid = any</text><line style="stroke:#181818;stroke-width:0.5;" x1="167.5" x2="365.5" y1="450.2305" y2="450.2305"/></g><path d="M401.5,325.5 L401.5,341.8105 L360.5,421.498 L401.5,349.8105 L401.5,366.1211 A0,0 0 0 0 401.5,366.1211 L563.5,366.1211 A0,0 0 0 0 563.5,366.1211 L563.5,335.5 L553.5,325.5 L401.5,325.5 A0,0 0 0 0 401.5,325.5 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M553.5,325.5 L553.5,335.5 L563.5,335.5 L553.5,325.5 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="407.5" y="343.0684">a Subdomain can only</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="407.5" y="358.3789">appear in one Account</text><path d="M401.5,376.1211 L401.5,423.0527 L347.5,437.9863 L401.5,431.0527 L401.5,477.9844 A0,0 0 0 0 401.5,477.9844 L607.5,477.9844 A0,0 0 0 0 607.5,477.9844 L607.5,386.1211 L597.5,376.1211 L401.5,376.1211 A0,0 0 0 0 401.5,376.1211 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M597.5,376.1211 L597.5,386.1211 L607.5,386.1211 L597.5,376.1211 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="22" x="407.5" y="393.6895">any</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="433.5" y="393.6895">naming requires an app</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="407.5" y="409">to PUT (sub)domain names.</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="28" x="407.5" y="424.3105">uuid</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="439.5" y="424.3105">naming allows any UUID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="407.5" y="439.6211">(sub)domain name, or gen</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="407.5" y="454.9316">with POST.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="407.5" y="470.2422">Other options may be added.</text><!--MD5=[48c89f8a025853fc7772f4a7999a1407]
class Subdomain--><g id="elem_Subdomain"><rect codeLine="55" fill="#F1F1F1" height="90.2422" id="Subdomain" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="196" y="548.5"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="55" x="239" y="565.1016">«domain»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="54" x="239.5" y="579.2344">«subject»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="227.5" y="595.3008">Subdomain</text><line style="stroke:#181818;stroke-width:0.5;" x1="197" x2="336" y1="603.2539" y2="603.2539"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="54" x="202" y="620.7891">account</text><text fill="#000000" font-family="sans-serif" font-size="11" font-style="italic" lengthAdjust="spacing" textLength="7" x="256" y="624.4219">p</text><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="64" x="267" y="620.7891">: Account</text><line style="stroke:#181818;stroke-width:0.5;" x1="197" x2="336" y1="630.7422" y2="630.7422"/></g><!--MD5=[fee662a292a0353a69bd162820bae93b]
entity User--><g id="elem_User"><ellipse cx="763.5" cy="14" fill="#F1F1F1" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M763.5,22 L763.5,49 M750.5,30 L776.5,30 M763.5,49 L750.5,64 M763.5,49 L776.5,64 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="748" y="79.0352">User</text></g><!--MD5=[873670755c6433d3512a8b316aa6820d]
class UserAccount--><g id="elem_UserAccount"><rect codeLine="34" fill="#F1F1F1" height="89.5977" id="UserAccount" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="139" x="616" y="166.5"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="54" x="658.5" y="183.1016">«subject»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="642" y="199.168">UserAccount</text><line style="stroke:#181818;stroke-width:0.5;" x1="617" x2="754" y1="207.1211" y2="207.1211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="622" y="224.6563">email : string [1..*]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="622" y="241.1445">key : UserKey [*]</text><line style="stroke:#181818;stroke-width:0.5;" x1="617" x2="754" y1="248.0977" y2="248.0977"/></g><path d="M418,186 L418,226.6211 A0,0 0 0 0 418,226.6211 L581,226.6211 A0,0 0 0 0 581,226.6211 L581,210.3105 L620,219.3652 L581,202.3105 L581,196 L571,186 L418,186 A0,0 0 0 0 418,186 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M571,186 L571,196 L581,196 L571,186 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="424" y="203.5684">Registered email, used</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="424" y="218.8789">for account activation</text><!--MD5=[169298fcae047c920cb45c646344fdd7]
class AuthKey--><g id="elem_AuthKey"><rect codeLine="93" fill="#F1F1F1" height="106.0859" id="AuthKey" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105" x="790" y="158.5"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="47" x="819" y="175.1016">«secret»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="814" y="191.168">AuthKey</text><line style="stroke:#181818;stroke-width:0.5;" x1="791" x2="894" y1="199.1211" y2="199.1211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="796" y="216.6563">keyid : string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="796" y="233.1445">appid : string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="796" y="249.6328">secret : string</text><line style="stroke:#181818;stroke-width:0.5;" x1="791" x2="894" y1="256.5859" y2="256.5859"/></g><!--MD5=[f5f68a7b4d1daa3f868d0f655b773560]
class OrganisationAccount--><g id="elem_OrganisationAccount"><rect codeLine="46" fill="#F1F1F1" height="73.1094" id="OrganisationAccount" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="303" x="106" y="7"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="54" x="230.5" y="23.6016">«subject»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="145" x="185" y="39.668">OrganisationAccount</text><line style="stroke:#181818;stroke-width:0.5;" x1="107" x2="408" y1="47.6211" y2="47.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="291" x="112" y="65.1563">vf:primaryAccountable : UserAccount [1..*]</text><line style="stroke:#181818;stroke-width:0.5;" x1="107" x2="408" y1="72.1094" y2="72.1094"/></g><path d="M444.5,26 L444.5,34.6553 L403,59.8652 L444.5,42.6553 L444.5,51.3105 A0,0 0 0 0 444.5,51.3105 L602.5,51.3105 A0,0 0 0 0 602.5,51.3105 L602.5,36 L592.5,26 L444.5,26 A0,0 0 0 0 444.5,26 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M592.5,26 L592.5,36 L602.5,36 L592.5,26 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="450.5" y="43.5684">The account "admins"</text><g id="elem_GMN22"><path d="M6,558 L6,629.2422 A0,0 0 0 0 6,629.2422 L161,629.2422 A0,0 0 0 0 161,629.2422 L161,597.5 L195.66,593.5 L161,589.5 L161,568 L151,558 L6,558 A0,0 0 0 0 6,558 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M151,558 L151,568 L161,568 L151,558 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="12" y="575.5684">a subject in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="12" y="590.8789">Gateway domain;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="12" y="606.1895">also a domain shared</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="12" y="621.5">to authorised clients</text></g><path d="M372,568 L372,584.3105 L331,616.998 L372,592.3105 L372,608.6211 A0,0 0 0 0 372,608.6211 L519,608.6211 A0,0 0 0 0 519,608.6211 L519,578 L509,568 L372,568 A0,0 0 0 0 372,568 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M509,568 L509,578 L519,578 L509,568 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="378" y="585.5684">entailed from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="378" y="600.8789">Account.subdomain</text><!--MD5=[033b72a131f47407b9f0b55998f42021]
class UserKey--><g id="elem_UserKey"><rect codeLine="71" fill="#F1F1F1" height="139.0625" id="UserKey" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="187" x="643" y="337"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="54" x="709.5" y="353.6016">«subject»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="709" y="369.668">UserKey</text><line style="stroke:#181818;stroke-width:0.5;" x1="644" x2="829" y1="377.6211" y2="377.6211"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="649" y="395.1563">@id =</text><text fill="#000000" font-family="monospace" font-size="14" lengthAdjust="spacing" textLength="88" x="693" y="394.8076">".${keyid}"</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="649" y="411.6445">name? : string</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170" x="649" y="428.1328">publicKey : base64Binary</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175" x="649" y="444.6211">privateKey : base64Binary</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="649" y="461.1094">revoked? : boolean</text><line style="stroke:#181818;stroke-width:0.5;" x1="644" x2="829" y1="468.0625" y2="468.0625"/></g><path d="M865,329 L865,346.8105 L745,406.3535 L865,354.8105 L865,372.6211 A0,0 0 0 0 865,372.6211 L1023,372.6211 A0,0 0 0 0 1023,372.6211 L1023,339 L1013,329 L865,329 A0,0 0 0 0 865,329 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1013,329 L1013,339 L1023,339 L1013,329 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="871" y="346.5684">account</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="921" y="350.2012">u</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="927" y="346.5684">@≪gateway≫</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="871" y="364.8789">Not present in config</text><path d="M865,382.6211 L865,391.2764 L824,439.3301 L865,399.2764 L865,407.9316 A0,0 0 0 0 865,407.9316 L1035,407.9316 A0,0 0 0 0 1035,407.9316 L1035,392.6211 L1025,382.6211 L865,382.6211 A0,0 0 0 0 865,382.6211 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1025,382.6211 L1025,392.6211 L1035,392.6211 L1025,382.6211 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="871" y="400.1895">Encrypted with AuthKey</text><path d="M865,417.9316 L865,441.8975 L778,455.8184 L865,449.8975 L865,473.8633 A0,0 0 0 0 865,473.8633 L1040,473.8633 A0,0 0 0 0 1040,473.8633 L1040,427.9316 L1030,417.9316 L865,417.9316 A0,0 0 0 0 865,417.9316 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1030,417.9316 L1030,427.9316 L1040,427.9316 L1030,417.9316 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="871" y="435.5">possibly redundant</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="871" y="450.8105">with external keystore</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="871" y="466.1211">Assumed</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="32" x="933" y="465.7974">true</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="969" y="466.1211">in config</text><g id="elem_GMN31"><path d="M930,191 L930,207.5 L895.09,211.5 L930,215.5 L930,231.6211 A0,0 0 0 0 930,231.6211 L1129,231.6211 A0,0 0 0 0 1129,231.6211 L1129,201 L1119,191 L930,191 A0,0 0 0 0 930,191 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1119,191 L1119,201 L1129,201 L1119,191 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="936" y="208.5684">String-serialised "API key"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="936" y="223.8789">Usable with Basic HTTP auth</text></g><!--MD5=[194d4a8dfc1f1dbb24ee205902653cbe]
reverse link Gateway to Account--><g id="link_Gateway_Account"><path codeLine="11" d="M278.49,276.94 C276.14,302.14 273.48,330.63 271.27,354.38 " fill="none" id="Gateway-backto-Account" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="279.72,263.71,275.1832,269.3151,278.6122,275.6588,283.149,270.0537,279.72,263.71" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="265.5189" y="343.6051">*</text></g><!--MD5=[25992f23a227de57e085562c6ccaa08b]
reverse link Account to Subdomain--><g id="link_Account_Subdomain"><path codeLine="30" d="M266.5,471.8 C266.5,497.03 266.5,525.36 266.5,548.23 " fill="none" id="Account-backto-Subdomain" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="266.5,458.54,262.5,464.54,266.5,470.54,270.5,464.54,266.5,458.54" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="260.0406" y="537.7232">*</text></g><!--MD5=[008ba0f0b6901373239fc7803ec7bfb5]
link UserAccount to Account--><g id="link_UserAccount_Account"><path codeLine="42" d="M615.57,256.38 C609.89,259.31 604.15,262.06 598.5,264.5 C507.73,303.76 474.12,283.67 384.5,325.5 C373.24,330.76 361.86,337.03 350.84,343.71 " fill="none" id="UserAccount-to-Account" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="354.52,349.67,333.88,354.47,347.02,337.85,354.52,349.67" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[378c3c1b132e255188f7374dad2a45ac]
link User to UserAccount--><g id="link_User_UserAccount"><path codeLine="43" d="M747.9,77.69 C736.6,101.75 721.13,134.67 708.42,161.72 " fill="none" id="User-to-UserAccount" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="706.25,166.35,713.6985,159.9064,708.3769,161.8249,706.4584,156.5033,706.25,166.35" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22" x="731.5" y="125.0684">has</text></g><!--MD5=[c7ffa2fa11327cf2ce82e85887dc3256]
link User to AuthKey--><g id="link_User_AuthKey"><path codeLine="44" d="M779.11,77.3 C789.48,99.09 803.37,128.28 815.51,153.78 " fill="none" id="User-to-AuthKey" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="817.75,158.49,817.5041,148.6442,815.6059,153.9731,810.277,152.0748,817.75,158.49" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22" x="803.5" y="125.0684">has</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="808.0211" y="147.9424">*</text></g><!--MD5=[3bd2f785ce7fba86ff840f78f2677824]
link OrganisationAccount to Account--><g id="link_OrganisationAccount_Account"><path codeLine="52" d="M219.46,80.19 C200.17,100.95 178.71,128.82 168.5,158.5 C153.17,203.05 154.41,219.54 168.5,264.5 C176.71,290.68 191.68,316.26 207.49,338.29 " fill="none" id="OrganisationAccount-to-Account" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="213.19,334.22,219.65,354.4,202.01,342.65,213.19,334.22" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[3e3ddf26659482ebc6db1edb96e472ec]
reverse link OrganisationAccount to UserAccount--><g id="link_OrganisationAccount_UserAccount"><path codeLine="53" d="M398.28,84.05 C460.8,103.51 534.56,129.12 598.5,158.5 C604.26,161.14 610.11,164.07 615.93,167.16 " fill="none" id="OrganisationAccount-backto-UserAccount" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="none" points="385.52,80.11,390.0688,85.7054,396.9833,83.6585,392.4345,78.0631,385.52,80.11" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22" x="585.9989" y="159.6604">1..*</text></g><!--MD5=[da11c875fea71f40e71ed49095cfc482]
reverse link UserAccount to UserKey--><g id="link_UserAccount_UserKey"><path codeLine="91" d="M700.56,269.49 C706.14,290.61 712.53,314.78 718.35,336.83 " fill="none" id="UserAccount-backto-UserKey" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="697.2,256.78,694.869,263.6039,700.2714,268.3803,702.6025,261.5563,697.2,256.78" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="690.2828" y="276.8207">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="6" x="710.1689" y="326.453">*</text></g><!--MD5=[83a6595460c68ab39a4b2676a9968ca6]
@startuml
'https://plantuml.com/class-diagram

hide circle
allowmixing

class Gateway <<domain>> <<service>> {
  rootAccount : UserAccount
  rootKey : AuthKey
}

Gateway *- - "*" Account

class Account <<abstract>> <<subject>> {
  subdomain : Subdomain [*]
  naming : any | uuid = any
}
note right of Account::subdomain
  a Subdomain can only
  appear in one Account
end note
note right of Account::naming
 //any// naming requires an app
 to PUT (sub)domain names.
 //uuid// naming allows any UUID
 (sub)domain name, or gen
 with POST.
 Other options may be added.
end note

Account *- - "*" Subdomain

actor User

class UserAccount <<subject>> {
  email : string [1..*]
  key : UserKey [*]
}
note left of UserAccount::email
  Registered email, used
  for account activation
end note
UserAccount - -|> Account
User ..> UserAccount: has
User ..> "*" AuthKey: has

class OrganisationAccount <<subject>> {
  vf:primaryAccountable : UserAccount [1..*]
}
note right of OrganisationAccount::vf:primaryAccountable
  The account "admins"
end note
OrganisationAccount - -|> Account
OrganisationAccount o- - "1..*" UserAccount

class Subdomain <<domain>> <<subject>> {
  //account<sub>p</sub> : Account//

}
note left of Subdomain
  a subject in the
  Gateway domain;
  also a domain shared
  to authorised clients
end note
note right of Subdomain::account
  entailed from
  Account.subdomain
end note


class UserKey <<subject>> {
  @id = """.${keyid}" ""
  name? : string
  publicKey : base64Binary
  privateKey : base64Binary
  revoked? : boolean
}
note right of UserKey::name
  account<sub>u</sub>@≪gateway≫
  Not present in config
end note
note right of UserKey::privateKey
  Encrypted with AuthKey
end note
note right of UserKey::revoked
  possibly redundant
  with external keystore
  Assumed ""true"" in config
end note

UserAccount "1" *- - "*" UserKey

class AuthKey <<secret>> {
  keyid : string
  appid : string
  secret : string
}
note right of AuthKey
  String-serialised "API key"
  Usable with Basic HTTP auth
end note

@enduml

@startuml

hide circle
allowmixing

class Gateway <<domain>> <<service>> {
  rootAccount : UserAccount
  rootKey : AuthKey
}

Gateway *- - "*" Account

class Account <<abstract>> <<subject>> {
  subdomain : Subdomain [*]
  naming : any | uuid = any
}
note right of Account::subdomain
  a Subdomain can only
  appear in one Account
end note
note right of Account::naming
 //any// naming requires an app
 to PUT (sub)domain names.
 //uuid// naming allows any UUID
 (sub)domain name, or gen
 with POST.
 Other options may be added.
end note

Account *- - "*" Subdomain

actor User

class UserAccount <<subject>> {
  email : string [1..*]
  key : UserKey [*]
}
note left of UserAccount::email
  Registered email, used
  for account activation
end note
UserAccount - -|> Account
User ..> UserAccount: has
User ..> "*" AuthKey: has

class OrganisationAccount <<subject>> {
  vf:primaryAccountable : UserAccount [1..*]
}
note right of OrganisationAccount::vf:primaryAccountable
  The account "admins"
end note
OrganisationAccount - -|> Account
OrganisationAccount o- - "1..*" UserAccount

class Subdomain <<domain>> <<subject>> {
  //account<sub>p</sub> : Account//

}
note left of Subdomain
  a subject in the
  Gateway domain;
  also a domain shared
  to authorised clients
end note
note right of Subdomain::account
  entailed from
  Account.subdomain
end note


class UserKey <<subject>> {
  @id = """.${keyid}" ""
  name? : string
  publicKey : base64Binary
  privateKey : base64Binary
  revoked? : boolean
}
note right of UserKey::name
  account<sub>u</sub>@≪gateway≫
  Not present in config
end note
note right of UserKey::privateKey
  Encrypted with AuthKey
end note
note right of UserKey::revoked
  possibly redundant
  with external keystore
  Assumed ""true"" in config
end note

UserAccount "1" *- - "*" UserKey

class AuthKey <<secret>> {
  keyid : string
  appid : string
  secret : string
}
note right of AuthKey
  String-serialised "API key"
  Usable with Basic HTTP auth
end note

@enduml

PlantUML version 1.2022.8(Sun Sep 25 10:00:33 BST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>