<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg"
     contentStyleType="text/css" height="583px" preserveAspectRatio="none"
     style="width:591px;height:583px;background:#FFFFFF;" version="1.1" viewBox="0 0 591 583"
     width="591px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="85.9316" style="stroke:#000000;stroke-width:1.5;" width="444.5" x="87.5" y="337.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="139" x2="139" y1="36.4883" y2="496.1465"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="139" x2="139" y1="496.1465" y2="537.1016"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="139" x2="139" y1="537.1016" y2="576.4121"/><rect fill="#FFFFFF" height="106.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="134" y="81.1094"/><rect fill="#FFFFFF" height="50.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="134" y="217.3516"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="134" y="386.2148"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="134" y="458.8359"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="516" x2="516" y1="36.4883" y2="496.1465"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="516" x2="516" y1="496.1465" y2="537.1016"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="516" x2="516" y1="537.1016" y2="576.4121"/><rect fill="#FFFFFF" height="456.6582" style="stroke:#181818;stroke-width:1.0;" width="10" x="511" y="44.4883"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="103.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="110.5" y="25.5352">Gateway</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42" x="495" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="502" y="25.5352">App</text><polygon fill="#181818" points="155,77.1094,145,81.1094,155,85.1094,151,81.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="149" x2="510" y1="81.1094" y2="81.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="161" y="61.0566">PUT /domain/≪acc≫/≪name≫</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="161" y="76.3672">Authorisation: ..</text><path d="M115.75,94.1094 L115.75,119.1094 L538.75,119.1094 L538.75,104.1094 L528.75,94.1094 L115.75,94.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M528.75,94.1094 L528.75,104.1094 L538.75,104.1094 L528.75,94.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="61" x="144" y="111.6777">from here</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="209" y="111.6777">"/domain/≪acc≫/≪name≫"</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="96" x="384" y="111.6777">will be denoted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="484" y="111.6777">"~"</text><line style="stroke:#181818;stroke-width:1.0;" x1="144" x2="186" y1="145.7305" y2="145.7305"/><line style="stroke:#181818;stroke-width:1.0;" x1="186" x2="186" y1="145.7305" y2="158.7305"/><line style="stroke:#181818;stroke-width:1.0;" x1="145" x2="186" y1="158.7305" y2="158.7305"/><polygon fill="#181818" points="155,154.7305,145,158.7305,155,162.7305,151,158.7305" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="151" y="140.9883">create/rev-up clone</text><polygon fill="#181818" points="499,184.041,509,188.041,499,192.041,503,188.041" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="144" x2="505" y1="188.041" y2="188.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="151" y="183.2988">200 OK {config}</text><polygon fill="#181818" points="155,213.3516,145,217.3516,155,221.3516,151,217.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="149" x2="510" y1="217.3516" y2="217.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232" x="161" y="212.6094">POST ~/poll {subscribe: ≪webhook≫}</text><path d="M10,201.041 L10,241.041 L134,241.041 L134,211.041 L124,201.041 L10,201.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M124,201.041 L124,211.041 L134,211.041 L124,201.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="16" y="218.6094">Poll creates lock</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="16" y="233.9199">and subscribes</text><polygon fill="#181818" points="499,263.9727,509,267.9727,499,271.9727,503,267.9727" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="144" x2="505" y1="267.9727" y2="267.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348" x="151" y="263.2305">201 Created ETag: "1" Location: ~/state?lock [Update 1]</text><line style="stroke:#181818;stroke-width:1.0;" x1="521" x2="563" y1="312.5938" y2="312.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="563" x2="563" y1="312.5938" y2="325.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="522" x2="563" y1="325.5938" y2="325.5938"/><polygon fill="#181818" points="532,321.5938,522,325.5938,532,329.5938,528,325.5938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="528" y="292.541">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="528" y="307.8516">Update 1</text><path d="M87.5,337.5938 L161.5,337.5938 L161.5,344.9043 L151.5,354.9043 L87.5,354.9043 L87.5,337.5938 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="85.9316" style="stroke:#000000;stroke-width:1.5;" width="444.5" x="87.5" y="337.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="102.5" y="351.1621">loop</text><polygon fill="#181818" points="155,382.2148,145,386.2148,155,390.2148,151,386.2148" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="149" x2="510" y1="386.2148" y2="386.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="161" y="381.4727">GET ~/state?query={ ... } If-Match: "1"</text><polygon fill="#181818" points="499,411.5254,509,415.5254,499,419.5254,503,415.5254" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="144" x2="505" y1="415.5254" y2="415.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="151" y="410.7832">200 OK:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="111" x="205" y="410.7832">chunked subjects</text><polygon fill="#181818" points="155,454.8359,145,458.8359,155,462.8359,151,458.8359" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="149" x2="510" y1="458.8359" y2="458.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213" x="161" y="454.0938">DELETE ~/state?lock If-Match: "1"</text><polygon fill="#181818" points="499,484.1465,509,488.1465,499,492.1465,503,488.1465" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="144" x2="505" y1="488.1465" y2="488.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="151" y="483.4043">200 OK</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="211" x="222" y="520.7813">interactions e.g. ←GET, ←POST, POST→</text><polygon fill="#181818" points="150,554.4121,140,558.4121,150,562.4121,146,558.4121" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="144" x2="515" y1="558.4121" y2="558.4121"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="156" y="553.6699">DELETE /subs</text><!--MD5=[f5997bf4d6ef90bb83a04ef6a69a66a6]
@startuml
'https://plantuml.com/sequence-diagram
!pragma teoz true
hide footbox

participant Gateway as gw
participant "App" as app

activate app
app -> gw ++: PUT /domain/≪acc≫/≪name≫\nAuthorisation: ..
note across
//from here// "/domain/≪acc≫/≪name≫" //will be denoted// "\~"
end note
gw -> gw: create/rev-up clone
return 200 OK {config}
app -> gw ++: POST \~/poll {subscribe: ≪webhook≫}
note left
Poll creates lock
and subscribes
end note
return 201 Created ETag: "1" Location: \~/state?lock [Update 1]
app -> app: process\nUpdate 1
loop
app -> gw ++: GET \~/state?query={ ... } If-Match: "1"
return 200 OK: //chunked subjects//
end loop
app -> gw ++: DELETE \~/state?lock If-Match: "1"
return 200 OK
deactivate app

...interactions e.g. ←GET, ←POST, POST→...
app -> gw: DELETE /subs

@enduml

@startuml
!pragma teoz true
hide footbox

participant Gateway as gw
participant "App" as app

activate app
app -> gw ++: PUT /domain/≪acc≫/≪name≫\nAuthorisation: ..
note across
//from here// "/domain/≪acc≫/≪name≫" //will be denoted// "\~"
end note
gw -> gw: create/rev-up clone
return 200 OK {config}
app -> gw ++: POST \~/poll {subscribe: ≪webhook≫}
note left
Poll creates lock
and subscribes
end note
return 201 Created ETag: "1" Location: \~/state?lock [Update 1]
app -> app: process\nUpdate 1
loop
app -> gw ++: GET \~/state?query={ ... } If-Match: "1"
return 200 OK: //chunked subjects//
end loop
app -> gw ++: DELETE \~/state?lock If-Match: "1"
return 200 OK
deactivate app

...interactions e.g. ←GET, ←POST, POST→...
app -> gw: DELETE /subs

@enduml

PlantUML version 1.2022.8(Sun Sep 25 10:00:33 BST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>