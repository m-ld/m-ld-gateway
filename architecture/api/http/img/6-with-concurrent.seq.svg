<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg"
     contentStyleType="text/css" height="945px" preserveAspectRatio="none"
     style="width:773px;height:945px;background:#FFFFFF;" version="1.1" viewBox="0 0 773 945"
     width="773px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="896.3281" style="stroke:#181818;stroke-width:0.5;" width="182" x="484" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="561" y="56.0566">App</text><rect fill="none" height="26.4883" id="_title" style="stroke:none;stroke-width:1.0;" width="177" x="413" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="167" x="418" y="28.5352">More Concurrent Cases</text><rect fill="none" height="326.2266" style="stroke:#000000;stroke-width:1.5;" width="616.5" x="61.5" y="106.2871"/><rect fill="none" height="459.3027" style="stroke:#000000;stroke-width:1.5;" width="759" x="8" y="450.5137"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="152" x2="152" y1="94.2871" y2="594.0664"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="152" x2="152" y1="594.0664" y2="635.0215"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="152" x2="152" y1="635.0215" y2="817.1953"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="152" x2="152" y1="817.1953" y2="845.1953"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="152" x2="152" y1="845.1953" y2="933.8164"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="147" y="154.9082"/><rect fill="#FFFFFF" height="152.3633" style="stroke:#181818;stroke-width:1.0;" width="10" x="147" y="213.5293"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="147" y="395.2031"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="147" y="499.1348"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="147" y="779.8848"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="147" y="866.5059"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="152" y="307.2715"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="529" x2="529" y1="94.2871" y2="594.0664"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="529" x2="529" y1="594.0664" y2="635.0215"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="529" x2="529" y1="635.0215" y2="817.1953"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="529" x2="529" y1="817.1953" y2="845.1953"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="529" x2="529" y1="845.1953" y2="933.8164"/><rect fill="#FFFFFF" height="215.9844" style="stroke:#181818;stroke-width:1.0;" width="10" x="524" y="133.5977"/><rect fill="#FFFFFF" height="116.2422" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="524" y="477.8242"/><line style="stroke:#181818;stroke-width:1.0;" x1="524" x2="524" y1="477.8242" y2="594.0664"/><line style="stroke:#181818;stroke-width:1.0;" x1="534" x2="534" y1="477.8242" y2="594.0664"/><line style="stroke:#181818;stroke-width:1.0;" x1="524" x2="534" y1="477.8242" y2="477.8242"/><rect fill="#FFFFFF" height="182.1738" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="524" y="635.0215"/><line style="stroke:#181818;stroke-width:1.0;" x1="524" x2="524" y1="635.0215" y2="817.1953"/><line style="stroke:#181818;stroke-width:1.0;" x1="534" x2="534" y1="635.0215" y2="817.1953"/><rect fill="#FFFFFF" height="69.6211" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="524" y="845.1953"/><line style="stroke:#181818;stroke-width:1.0;" x1="524" x2="524" y1="845.1953" y2="914.8164"/><line style="stroke:#181818;stroke-width:1.0;" x1="534" x2="534" y1="845.1953" y2="914.8164"/><line style="stroke:#181818;stroke-width:1.0;" x1="524" x2="534" y1="914.8164" y2="914.8164"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="621" x2="621" y1="94.2871" y2="594.0664"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="621" x2="621" y1="594.0664" y2="635.0215"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="621" x2="621" y1="635.0215" y2="817.1953"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="621" x2="621" y1="817.1953" y2="845.1953"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="621" x2="621" y1="845.1953" y2="933.8164"/><rect fill="#FFFFFF" height="245.2949" style="stroke:#181818;stroke-width:1.0;" width="10" x="616" y="192.2188"/><rect fill="#FFFFFF" height="165.8633" style="stroke:#181818;stroke-width:1.0;" width="10" x="616" y="656.332"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="116.5" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="123.5" y="83.334">Gateway</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="488" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="495" y="83.334">(thread 1)</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="580" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="587" y="83.334">(thread 2)</text><path d="M61.5,106.2871 L265.5,106.2871 L265.5,113.5977 L255.5,123.5977 L61.5,123.5977 L61.5,106.2871 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="326.2266" style="stroke:#000000;stroke-width:1.5;" width="616.5" x="61.5" y="106.2871"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="155" x="76.5" y="119.8555">concurrent write &amp; poll</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="41" x="280.5" y="118.9219">[happy]</text><polygon fill="#181818" points="168,150.9082,158,154.9082,168,158.9082,164,154.9082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="162" x2="523" y1="154.9082" y2="154.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="174" y="150.166">POST ~/state { ... }</text><polygon fill="#181818" points="512,180.2188,522,184.2188,512,188.2188,516,184.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="157" x2="518" y1="184.2188" y2="184.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348" x="164" y="179.4766">201 Created ETag: "1" Location: ~/state?lock {Update 1}</text><polygon fill="#181818" points="168,209.5293,158,213.5293,168,217.5293,164,213.5293" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="162" x2="615" y1="213.5293" y2="213.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="174" y="208.7871">POST ~/poll</text><path d="M82.5,240.3398 L82.5,280.3398 L221.5,280.3398 L221.5,250.3398 L211.5,240.3398 L82.5,240.3398 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M211.5,240.3398 L211.5,250.3398 L221.5,250.3398 L211.5,240.3398 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="88.5" y="257.9082">poll is delayed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="88.5" y="273.2188">by pending Update</text><line style="stroke:#181818;stroke-width:1.0;" x1="534" x2="576" y1="258.1504" y2="258.1504"/><line style="stroke:#181818;stroke-width:1.0;" x1="576" x2="576" y1="258.1504" y2="271.1504"/><line style="stroke:#181818;stroke-width:1.0;" x1="535" x2="576" y1="271.1504" y2="271.1504"/><polygon fill="#181818" points="545,267.1504,535,271.1504,545,275.1504,541,271.1504" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="541" y="238.0977">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="541" y="253.4082">Update 1</text><polygon fill="#181818" points="173,303.2715,163,307.2715,173,311.2715,169,307.2715" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="167" x2="523" y1="307.2715" y2="307.2715"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213" x="179" y="302.5293">DELETE ~/state?lock If-Match: "1"</text><polygon fill="#181818" points="512,332.582,522,336.582,512,340.582,516,336.582" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="162" x2="518" y1="336.582" y2="336.582"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="169" y="331.8398">200 OK</text><polygon fill="#181818" points="604,361.8926,614,365.8926,604,369.8926,608,365.8926" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="157" x2="610" y1="365.8926" y2="365.8926"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292" x="164" y="361.1504">201 Created ETag: "1" Location: ~/state?lock []</text><polygon fill="#181818" points="168,391.2031,158,395.2031,168,399.2031,164,395.2031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="162" x2="615" y1="395.2031" y2="395.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213" x="174" y="390.4609">DELETE ~/state?lock If-Match: "1"</text><polygon fill="#181818" points="604,420.5137,614,424.5137,604,428.5137,608,424.5137" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="157" x2="610" y1="424.5137" y2="424.5137"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="164" y="419.7715">200 OK</text><path d="M8,450.5137 L225,450.5137 L225,457.8242 L215,467.8242 L8,467.8242 L8,450.5137 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="459.3027" style="stroke:#000000;stroke-width:1.5;" width="759" x="8" y="450.5137"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="23" y="464.082">timeout write processing</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="55" x="240" y="463.1484">[unhappy]</text><polygon fill="#181818" points="168,495.1348,158,499.1348,168,503.1348,164,499.1348" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="162" x2="523" y1="499.1348" y2="499.1348"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="174" y="494.3926">POST ~/state { ... }</text><polygon fill="#181818" points="512,524.4453,522,528.4453,512,532.4453,516,528.4453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="157" x2="518" y1="528.4453" y2="528.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348" x="164" y="523.7031">201 Created ETag: "1" Location: ~/state?lock {Update 1}</text><line style="stroke:#181818;stroke-width:1.0;" x1="534" x2="576" y1="573.0664" y2="573.0664"/><line style="stroke:#181818;stroke-width:1.0;" x1="576" x2="576" y1="573.0664" y2="586.0664"/><line style="stroke:#181818;stroke-width:1.0;" x1="535" x2="576" y1="586.0664" y2="586.0664"/><polygon fill="#181818" points="545,582.0664,535,586.0664,545,590.0664,541,586.0664" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="541" y="553.0137">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="541" y="568.3242">Update 1</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="181" x="296" y="618.7012">lock timeout but not actually dead</text><polygon fill="#181818" points="604,652.332,614,656.332,604,660.332,608,656.332" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="152" x2="610" y1="656.332" y2="656.332"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348" x="159" y="651.5898">POST /webhook?ETag="1" {Update 1, dequeueCount=2}</text><path d="M29,640.0215 L29,695.0215 L147,695.0215 L147,650.0215 L137,640.0215 L29,640.0215 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M137,640.0215 L137,650.0215 L147,650.0215 L137,640.0215 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="35" y="657.5898">dequeueCount</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="35" y="672.9004">warns Update 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="35" y="688.2109">is pending</text><path d="M631,640.0215 L631,665.0215 L746,665.0215 L746,650.0215 L736,640.0215 L631,640.0215 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M736,640.0215 L736,650.0215 L746,650.0215 L736,640.0215 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="637" y="657.5898">ignore warning</text><line style="stroke:#181818;stroke-width:1.0;" x1="626" x2="668" y1="737.5742" y2="737.5742"/><line style="stroke:#181818;stroke-width:1.0;" x1="668" x2="668" y1="737.5742" y2="750.5742"/><line style="stroke:#181818;stroke-width:1.0;" x1="627" x2="668" y1="750.5742" y2="750.5742"/><polygon fill="#181818" points="637,746.5742,627,750.5742,637,754.5742,633,750.5742" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="633" y="717.5215">process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="633" y="732.832">Update 1</text><path d="M460,705.9531 L460,745.9531 L616,745.9531 L616,715.9531 L606,705.9531 L460,705.9531 " fill="#FFC0CB" style="stroke:#181818;stroke-width:0.5;"/><path d="M606,705.9531 L606,715.9531 L616,715.9531 L606,705.9531 " fill="#FFC0CB" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="466" y="723.5215">duplicate processing!</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="466" y="738.832">(OK if idempotent)</text><polygon fill="#181818" points="168,775.8848,158,779.8848,168,783.8848,164,779.8848" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="162" x2="615" y1="779.8848" y2="779.8848"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213" x="174" y="775.1426">DELETE ~/state?lock If-Match: "1"</text><polygon fill="#181818" points="604,805.1953,614,809.1953,604,813.1953,608,809.1953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="157" x2="610" y1="809.1953" y2="809.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="164" y="804.4531">200 OK</text><polygon fill="#181818" points="168,862.5059,158,866.5059,168,870.5059,164,866.5059" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="162" x2="523" y1="866.5059" y2="866.5059"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213" x="174" y="861.7637">DELETE ~/state?lock If-Match: "1"</text><polygon fill="#181818" points="512,891.8164,522,895.8164,512,899.8164,516,895.8164" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="157" x2="518" y1="895.8164" y2="895.8164"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="164" y="891.0742">404 Not Found</text><path d="M539,879.5059 L539,904.5059 L732,904.5059 L732,889.5059 L722,879.5059 L539,879.5059 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M722,879.5059 L722,889.5059 L732,889.5059 L722,879.5059 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="545" y="897.0742">lock is not found (ETag OK)</text><!--MD5=[3dad50641863f22a41d623ccfa76deb6]
@startuml
'https://plantuml.com/sequence-diagram
!pragma teoz true
hide footbox

title More Concurrent Cases

participant Gateway as gw
box App
participant "(thread 1)" as app
participant "(thread 2)" as app2
end box

group concurrent write & poll [happy]
activate app
app -> gw ++: POST \~/state { ... }
return 201 Created ETag: "1" Location: \~/state?lock {Update 1}
activate app2
app2 -> gw ++: POST \~/poll
note over gw
poll is delayed
by pending Update
end note
& app -> app: process\nUpdate 1
app -> gw ++: DELETE \~/state?lock If-Match: "1"
return 200 OK
deactivate app
gw - -> app2 - -: 201 Created ETag: "1" Location: \~/state?lock []
app2 -> gw ++: DELETE \~/state?lock If-Match: "1"
return 200 OK
deactivate app2
end group

group timeout write processing [unhappy]
activate app
app -> gw ++: POST \~/state { ... }
return 201 Created ETag: "1" Location: \~/state?lock {Update 1}
app -> app: process\nUpdate 1
...lock timeout but not actually dead...
gw -> app2 ++: POST /webhook?ETag="1" {Update 1, dequeueCount=2}
note left
dequeueCount
warns Update 1
is pending
end note
note right: ignore warning
app2 -> app2: process\nUpdate 1
note left #pink
duplicate processing!
(OK if idempotent)
end note
app2 -> gw ++: DELETE \~/state?lock If-Match: "1"
return 200 OK
deactivate app2
...
app -> gw ++: DELETE \~/state?lock If-Match: "1"
return 404 Not Found
note right: lock is not found (ETag OK)
deactivate app
end group

@enduml

@startuml
!pragma teoz true
hide footbox

title More Concurrent Cases

participant Gateway as gw
box App
participant "(thread 1)" as app
participant "(thread 2)" as app2
end box

group concurrent write & poll [happy]
activate app
app -> gw ++: POST \~/state { ... }
return 201 Created ETag: "1" Location: \~/state?lock {Update 1}
activate app2
app2 -> gw ++: POST \~/poll
note over gw
poll is delayed
by pending Update
end note
& app -> app: process\nUpdate 1
app -> gw ++: DELETE \~/state?lock If-Match: "1"
return 200 OK
deactivate app
gw - -> app2 - -: 201 Created ETag: "1" Location: \~/state?lock []
app2 -> gw ++: DELETE \~/state?lock If-Match: "1"
return 200 OK
deactivate app2
end group

group timeout write processing [unhappy]
activate app
app -> gw ++: POST \~/state { ... }
return 201 Created ETag: "1" Location: \~/state?lock {Update 1}
app -> app: process\nUpdate 1
...lock timeout but not actually dead...
gw -> app2 ++: POST /webhook?ETag="1" {Update 1, dequeueCount=2}
note left
dequeueCount
warns Update 1
is pending
end note
note right: ignore warning
app2 -> app2: process\nUpdate 1
note left #pink
duplicate processing!
(OK if idempotent)
end note
app2 -> gw ++: DELETE \~/state?lock If-Match: "1"
return 200 OK
deactivate app2
...
app -> gw ++: DELETE \~/state?lock If-Match: "1"
return 404 Not Found
note right: lock is not found (ETag OK)
deactivate app
end group

@enduml

PlantUML version 1.2022.8(Sun Sep 25 10:00:33 BST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>